//****************************************************************************
//
//                               cfgebi.c
//
//****************************************************************************
//
//                    Copyrights(c) 2022 by KNORR-BREMSE,
//               Systeme fuer Schienenfahrzeuge GmbH, Muenchen
//
//! @project   ESRA BSW3G55xx
//! @date      2011-04-04
//! @author    P. Sigl
//
//****************************************************************************
//
//! @file
//! @brief  EBI config
//
//****************************************************************************
// Date        Author      Changes:
// 2011-04-04  P. Sigl     Initial revision for EB01
// 2013-07-30  A. Mauro    Changed SCY from 2 to 3
// 2014-02-14  A. Mauro    Changed PS from 0 to 1
// 2017.04.18  A. Mauro    TC_007-96: LINT clean up
//****************************************************************************
//Note: Suppression of "Wrong derived data type", these warnings come from the naming convention violation
//      of their respective structures
//******************* Compiler options ( #pragma ) ***************************

//******************* Header / include files ( #include ) ********************
#include "55xxebi_i.h"                  // EBI internal definitions

//******************* Constant / macro definitions ( #define ) ***************

#define EBI_CS_MAX 4                    //!< Max. number of chip selects
                                        //!< available.

#define EBI_M1     0x1UL                //!< Masks 1 bit
#define EBI_M2     0x3UL                //!< Masks 2 bits
#define EBI_M3     0x7UL                //!< Masks 3 bits
#define EBI_M4     0xFUL                //!< Masks 4 bits
#define EBI_M8     0xFFUL               //!< Masks 8 bits
#define EBI_M17    0x1FFFFUL            //!< Masks 17 bits

//! Macro for building a EBI MCR register value
#define EBI_SET_MCR(sizen, size, acge, extm, earb, earp, mdis, dbm) \
        ((U32)( (((sizen) & EBI_M1) << 26U) |  \
                (((size)  & EBI_M3) << 24U) |  \
                (((acge)  & EBI_M1) << 15U) |  \
                (((extm)  & EBI_M1) << 14U) |  \
                (((earb)  & EBI_M2) << 13U) |  \
                (((earp)  & EBI_M2) << 11U) |  \
                (((mdis)  & EBI_M1) << 6U ) |  \
                (((dbm)   & EBI_M1)      ) ))

//! Macro for building a EBI BMCR register value
#define EBI_SET_BMCR(bmt, bme) \
        ((U32)( (((bmt) & EBI_M8) << 8U) |  \
                (((bme) & EBI_M3) << 7U) ))

//! Macro for building a EBI BR register value
#define EBI_SET_BR(ba, ps, bl, webs, tbdip, bi, v) \
        ((U32)( (((ba)    & EBI_M17) << 15U) |  \
                (((ps)    & EBI_M1)  << 11U) |  \
                (((bl)    & EBI_M1)  <<  6U) |  \
                (((webs)  & EBI_M1)  <<  5U) |  \
                (((tbdip) & EBI_M1)  <<  4U) |  \
                (((bi)    & EBI_M1)  <<  1U) |  \
                (((v)     & EBI_M1)       ) ))

//! Macro for building a EBI OR register value
#define EBI_SET_OR(am, scy, bscy) \
        ((U32)( (((am)    & EBI_M17) << 15U) |  \
                (((scy)   & EBI_M4)  <<  4U) |  \
                (((bscy)  & EBI_M2)  <<  1U) ))


//****************************************************************************
//! Maximum number of EBI chip selects
//****************************************************************************
const U8 u8EBI_CS_MAX = EBI_CS_MAX;


//****************************************************************************
//! EBI Module Configuration Config
//****************************************************************************

const tcEBI_MCR_CFG cEBI_MCR_CFG = // @suppress("Wrong derived data type")
  {
  //--------------------------------------------------------------------------
  // boUseCfg        u32EBI_MCR
  //--------------------------------------------------------------------------
                                 // SIZEN SIZE ACGE EXTM EARB EARP MDIS DBM
     TRUE,           EBI_SET_MCR (  0UL,  0UL, 0UL, 0UL, 1UL, 0UL, 0UL, 1UL  )
  };


//****************************************************************************
//! EBI Bus Monitor Control Config
//****************************************************************************

const tcEBI_BMCR_CFG cEBI_BMCR_CFG = // @suppress("Wrong derived data type")
  {
  //--------------------------------------------------------------------------
  // boUseCfg        u32EBI_BMCR
  //--------------------------------------------------------------------------
                                  // BMT  BME
     TRUE,           EBI_SET_BMCR ( 3UL,  0UL  )
  };


//****************************************************************************
//! EBI Chip Select Config
//****************************************************************************

const tcEBI_CS_CFG pcEBI_CS_CFG[EBI_CS_MAX] = // @suppress("Wrong derived data type")
  {
    {
    //------------------------------------------------------------------------
    // Chip select 0: PS-RAM
    //------------------------------------------------------------------------

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_BR      (Basis is 2000_0000)
      //----------------------------------------------------------------------
                                 // BA        PS   BL   WEBS  TBDIP  BI    V
      {  TRUE,        EBI_SET_BR (  0x0000UL, 1UL, 1UL, 1UL,  0UL,   1UL,  1UL ) },

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_OR
      //----------------------------------------------------------------------
                                 // AM                SCY    BSCY
      {  TRUE,        EBI_SET_OR (  0xFF80UL << 1UL,  3UL,   0UL   ) }
    },
    {
    //------------------------------------------------------------------------
    // Chip select 1: ---
    //------------------------------------------------------------------------

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_BR
      //----------------------------------------------------------------------
      {  FALSE,       0UL },

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_OR
      //----------------------------------------------------------------------
      {  FALSE,       0UL }
    },
    {
    //------------------------------------------------------------------------
    // Chip select 2: ---
    //------------------------------------------------------------------------

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_BR
      //----------------------------------------------------------------------
      {  FALSE,       0UL },

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_OR
      //----------------------------------------------------------------------
      {  FALSE,       0UL }
    },
    {
    //------------------------------------------------------------------------
    // Chip select 3: ---
    //------------------------------------------------------------------------

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_BR
      //----------------------------------------------------------------------
      {  FALSE,       0UL },

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_OR
      //----------------------------------------------------------------------
      {  FALSE,       0UL }
    }
  };


//****************************************************************************
//! EBI Calibration Chip Select Config
//****************************************************************************

const tcEBI_CS_CFG pcEBI_CALCS_CFG[EBI_CS_MAX] = // @suppress("Wrong derived data type")
  {
    {
    //------------------------------------------------------------------------
    // Calibration Chip Select 0: unused / not available
    //------------------------------------------------------------------------

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_BR
      //----------------------------------------------------------------------
      {  FALSE,       0UL },

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_OR
      //----------------------------------------------------------------------
      {  FALSE,       0UL }
    },
    {
    //------------------------------------------------------------------------
    // Calibration Chip Select 1: unused / not available
    //------------------------------------------------------------------------

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_BR
      //----------------------------------------------------------------------
      {  FALSE,       0UL },

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_OR
      //----------------------------------------------------------------------
      {  FALSE,       0UL }
    },
    {
    //------------------------------------------------------------------------
    // Calibration Chip Select 2: unused / not available
    //------------------------------------------------------------------------

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_BR
      //----------------------------------------------------------------------
      {  FALSE,       0UL },

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_OR
      //----------------------------------------------------------------------
      {  FALSE,       0UL }
    },
    {
    //------------------------------------------------------------------------
    // Calibration Chip Select 3: unused / not available
    //------------------------------------------------------------------------

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_BR
      //----------------------------------------------------------------------
      {  FALSE,       0UL },

      //----------------------------------------------------------------------
      // boUseCfg     u32EBI_OR
      //----------------------------------------------------------------------
      {  FALSE,       0UL }
    }
  };

//******************* Type definitions ( typedef ) ***************************

//******************* Global scope data definitions **************************

//******************* Global scope read only definitions ( const ) ***********

//******************* Module scope data segment ( static ) *******************

//******************* Module scope read only variables ( static const ) ******

//******************* Module scope func/proc prototypes ( static )************

//** EndOfHeader *************************************************************

//** EndOfFile cfgebi.c ******************************************************
